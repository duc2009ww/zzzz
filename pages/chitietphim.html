<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chi ti·∫øt phim</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .movie-poster { max-width: 100%; border-radius: 10px; }
    .movie-info { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .rating i { color: gold; cursor: pointer; font-size: 1.4rem; }
    .rating i.inactive { color: #ccc; }
    .comment-box { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    #episodeList button { min-width: 80px; }
    #episodeList button:hover { background-color: #000; color: #fff; }
  </style>
</head>
<body>

  <div class="container mt-5">
    <a href="../index.html" class="btn btn-secondary mb-3">‚¨Ö Quay l·∫°i</a>

    <div id="movie-detail" class="row g-4"></div>

    <div id="trailer" class="row mt-5"></div>

    <!-- Danh s√°ch t·∫≠p phim -->
    <div class="row mt-5">
      <div class="col-12">
        <h3>üì∫ Danh s√°ch t·∫≠p phim</h3>
        <div id="episodeList" class="d-flex flex-wrap gap-2 mt-3"></div>

        <!-- khung video ph√°t t·∫≠p -->
        <div id="episodePlayer" class="ratio ratio-16x9 mt-4 d-none">
          <iframe id="episodeFrame" src="" allowfullscreen></iframe>
        </div>
      </div>
    </div>

    <!-- B√¨nh lu·∫≠n -->
    <div class="row mt-5">
      <div class="col-12">
        <h3>üí¨ B√¨nh lu·∫≠n</h3>
        <div class="comment-box mt-3">
          <form id="commentForm">
            <div class="mb-3">
              <textarea id="commentText" class="form-control" rows="3" placeholder="Vi·∫øt b√¨nh lu·∫≠n..." required></textarea>
            </div>
            <button type="submit" class="btn btn-dark">G·ª≠i</button>
          </form>
          <ul class="list-group mt-3" id="comments"></ul>
        </div>
      </div>
    </div>
  </div>

  <script src="../js/API.js"></script>
  <!-- <script>
    // ======== L·∫§Y PHIM T·ª™ URL ========
    const params = new URLSearchParams(window.location.search);
    const movieId = parseInt(params.get("id"));
    const movie = movies.find(m => m.id === movieId);

    const movieDetail = document.getElementById("movie-detail");
    const trailerDiv = document.getElementById("trailer");

    if (!movie) {
      movieDetail.innerHTML = `<h4 class="text-danger">Kh√¥ng t√¨m th·∫•y phim!</h4>`;
    } else {
      document.title = `Chi ti·∫øt phim - ${movie.title}`;
      movieDetail.innerHTML = `
        <div class="col-md-4 text-center">
          <img src="${movie.image}" alt="${movie.title}" class="movie-poster shadow">
        </div>
        <div class="col-md-8">
          <div class="movie-info">
            <h2>${movie.title}</h2>
            <ul class="list-unstyled">
              <li><strong>NƒÉm:</strong> ${movie.year}</li>
              <li><strong>Th·ªÉ lo·∫°i:</strong> ${movie.genre}</li>
              <li><strong>ƒê·∫°o di·ªÖn:</strong> ${movie.director}</li>
              <li><strong>Di·ªÖn vi√™n:</strong> ${movie.cast}</li>
              <li><strong>Th·ªùi l∆∞·ª£ng:</strong> ${movie.duration}</li>
            </ul>
            <div class="rating mb-3" id="starRating">
              <strong>ƒê√°nh gi√° c·ªßa b·∫°n:</strong><br>
              <i class="bi bi-star inactive" data-rate="1"></i>
              <i class="bi bi-star inactive" data-rate="2"></i>
              <i class="bi bi-star inactive" data-rate="3"></i>
              <i class="bi bi-star inactive" data-rate="4"></i>
              <i class="bi bi-star inactive" data-rate="5"></i>
              <span id="ratingValue" class="ms-2">(ch∆∞a c√≥)</span>
            </div>
            <p>${movie.description}</p>
          </div>
        </div>
      `;

      trailerDiv.innerHTML = `
        <div class="col-12 mt-4">
          <h3>üéû Trailer</h3>
          <div class="ratio ratio-16x9">
            <iframe src="${movie.trailer}" allowfullscreen></iframe>
          </div>
        </div>
      `;

      // ======== DANH S√ÅCH T·∫¨P PHIM ========
      const episodeList = document.getElementById("episodeList");
      const episodePlayer = document.getElementById("episodePlayer");
      const episodeFrame = document.getElementById("episodeFrame");

      movie.episodes.forEach(ep => {
        const btn = document.createElement("button");
        btn.className = "btn btn-outline-dark btn-sm";
        btn.textContent = `T·∫≠p ${ep.ep}`;
        btn.addEventListener("click", () => {
          episodeFrame.src = ep.url;
          episodePlayer.classList.remove("d-none");
          episodePlayer.scrollIntoView({ behavior: "smooth" });
        });
        episodeList.appendChild(btn);
      });
    }

    // ======== ƒê√ÅNH GI√Å SAO ========
    const stars = document.querySelectorAll("#starRating i");
    const ratingValue = document.getElementById("ratingValue");
    const ratingKey = `rating_${movieId}`;

    let currentRating = localStorage.getItem(ratingKey) || 0;
    highlightStars(currentRating);

    stars.forEach(star => {
      star.addEventListener("click", () => {
        const rate = parseInt(star.getAttribute("data-rate"));
        localStorage.setItem(ratingKey, rate);
        highlightStars(rate);
      });
    });

    function highlightStars(rating) {
      stars.forEach(s => {
        s.classList.remove("bi-star-fill");
        s.classList.add("inactive");
      });
      for (let i = 0; i < rating; i++) {
        stars[i].classList.add("bi-star-fill");
        stars[i].classList.remove("inactive");
      }
      ratingValue.textContent = rating > 0 ? `(${rating}/5 sao)` : "(ch∆∞a c√≥)";
    }

    // ======== B√åNH LU·∫¨N (localStorage) ========
    const form = document.getElementById('commentForm');
    const text = document.getElementById('commentText');
    const list = document.getElementById('comments');
    const commentKey = `comments_${movieId}`;

    // Load b√¨nh lu·∫≠n c≈©
    const savedComments = JSON.parse(localStorage.getItem(commentKey)) || [];
    savedComments.forEach(c => addCommentToList(c));

    form.addEventListener('submit', e => {
      e.preventDefault();
      const comment = text.value.trim();
      if (comment) {
        addCommentToList(comment);
        savedComments.unshift(comment);
        localStorage.setItem(commentKey, JSON.stringify(savedComments));
        text.value = '';
      }
    });

    function addCommentToList(comment) {
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.textContent = comment;
      list.prepend(li);
    }
  </script> -->
</body>
</html>
